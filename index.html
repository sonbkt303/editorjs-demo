<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Editor.js Demo</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }

        header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .editor-wrapper {
            background: white;
            border-radius: 12px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            padding: 40px;
            margin-bottom: 20px;
        }

        #editorjs {
            min-height: 400px;
        }

        .controls {
            text-align: center;
            margin-bottom: 20px;
        }

        .btn {
            background: white;
            color: #667eea;
            border: none;
            padding: 12px 24px;
            font-size: 16px;
            font-weight: 600;
            border-radius: 8px;
            cursor: pointer;
            margin: 0 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            transition: all 0.3s ease;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.2);
        }

        .btn:active {
            transform: translateY(0);
        }

        .output {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            display: none;
        }

        .output.show {
            display: block;
        }

        .output h3 {
            color: #667eea;
            margin-bottom: 15px;
        }

        .output pre {
            background: #f5f5f5;
            padding: 15px;
            border-radius: 8px;
            overflow-x: auto;
            font-size: 14px;
            line-height: 1.5;
        }

        /* Editor.js custom styling */
        .ce-toolbar__content,
        .ce-block__content {
            max-width: 100%;
        }

        .codex-editor__redactor {
            padding-bottom: 0 !important;
        }

        /* Custom inline tool styles */
        .cdx-bold {
            font-weight: bold;
        }

        .cdx-italic {
            font-style: italic;
        }

        .cdx-underline {
            text-decoration: underline;
        }

        .cdx-font-small {
            font-size: 0.85em;
        }

        .cdx-font-normal {
            font-size: 1em;
        }

        .cdx-font-large {
            font-size: 1.25em;
        }

        .cdx-font-xlarge {
            font-size: 1.5em;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üìù Editor.js Demo</h1>
            <p>A block-styled editor with clean JSON output</p>
        </header>

        <div class="controls">
            <button class="btn" onclick="saveData()">üíæ Save Data</button>
            <button class="btn" onclick="clearEditor()">üóëÔ∏è Clear Editor</button>
            <button class="btn" onclick="loadSample()">üìÑ Load Sample</button>
        </div>

        <div class="editor-wrapper">
            <div id="editorjs"></div>
        </div>

        <div id="output" class="output">
            <h3>Saved Data (JSON):</h3>
            <pre id="output-data"></pre>
        </div>
    </div>

    <script src="node_modules/@editorjs/editorjs/dist/editorjs.umd.js"></script>
    <script src="node_modules/@editorjs/header/dist/header.umd.js"></script>
    <script src="node_modules/@editorjs/list/dist/list.umd.js"></script>
    <script src="node_modules/@editorjs/image/dist/image.umd.js"></script>
    <script src="node_modules/@editorjs/checklist/dist/checklist.umd.js"></script>
    <script src="node_modules/@editorjs/quote/dist/quote.umd.js"></script>
    <script src="node_modules/@editorjs/code/dist/code.umd.js"></script>
    <script src="node_modules/@editorjs/embed/dist/embed.umd.js"></script>
    <script src="node_modules/@editorjs/table/dist/table.umd.js"></script>
    <script src="node_modules/@editorjs/link/dist/link.umd.js"></script>
    <script src="node_modules/@editorjs/warning/dist/warning.umd.js"></script>
    <script src="node_modules/@editorjs/marker/dist/marker.umd.js"></script>
    <script src="node_modules/@editorjs/inline-code/dist/inline-code.umd.js"></script>

    <script>
        // Custom Bold Inline Tool
        class BoldInlineTool {
            static get isInline() {
                return true;
            }

            static get sanitize() {
                return {
                    b: {},
                    strong: {}
                };
            }

            get state() {
                return this._state;
            }

            set state(state) {
                this._state = state;
                this.button.classList.toggle('ce-inline-tool--active', state);
            }

            constructor({ api }) {
                this.api = api;
                this.button = null;
                this._state = false;
                this.tag = 'B';
                this.class = 'cdx-bold';
            }

            render() {
                this.button = document.createElement('button');
                this.button.type = 'button';
                this.button.innerHTML = '<b>B</b>';
                this.button.classList.add('ce-inline-tool');
                return this.button;
            }

            surround(range) {
                if (this.state) {
                    this.unwrap(range);
                    return;
                }
                this.wrap(range);
            }

            wrap(range) {
                const selectedText = range.extractContents();
                const mark = document.createElement(this.tag);
                mark.classList.add(this.class);
                mark.appendChild(selectedText);
                range.insertNode(mark);
                this.api.selection.expandToTag(mark);
            }

            unwrap(range) {
                const mark = this.api.selection.findParentTag(this.tag, this.class);
                const text = range.extractContents();
                mark.remove();
                range.insertNode(text);
            }

            checkState() {
                const mark = this.api.selection.findParentTag(this.tag);
                this.state = !!mark;
            }

            static get shortcut() {
                return 'CMD+B';
            }
        }

        // Custom Italic Inline Tool
        class ItalicInlineTool {
            static get isInline() {
                return true;
            }

            static get sanitize() {
                return {
                    i: {},
                    em: {}
                };
            }

            get state() {
                return this._state;
            }

            set state(state) {
                this._state = state;
                this.button.classList.toggle('ce-inline-tool--active', state);
            }

            constructor({ api }) {
                this.api = api;
                this.button = null;
                this._state = false;
                this.tag = 'I';
                this.class = 'cdx-italic';
            }

            render() {
                this.button = document.createElement('button');
                this.button.type = 'button';
                this.button.innerHTML = '<i>I</i>';
                this.button.classList.add('ce-inline-tool');
                return this.button;
            }

            surround(range) {
                if (this.state) {
                    this.unwrap(range);
                    return;
                }
                this.wrap(range);
            }

            wrap(range) {
                const selectedText = range.extractContents();
                const mark = document.createElement(this.tag);
                mark.classList.add(this.class);
                mark.appendChild(selectedText);
                range.insertNode(mark);
                this.api.selection.expandToTag(mark);
            }

            unwrap(range) {
                const mark = this.api.selection.findParentTag(this.tag, this.class);
                const text = range.extractContents();
                mark.remove();
                range.insertNode(text);
            }

            checkState() {
                const mark = this.api.selection.findParentTag(this.tag);
                this.state = !!mark;
            }

            static get shortcut() {
                return 'CMD+I';
            }
        }

        // Custom Underline Inline Tool
        class UnderlineInlineTool {
            static get isInline() {
                return true;
            }

            static get sanitize() {
                return {
                    u: {}
                };
            }

            get state() {
                return this._state;
            }

            set state(state) {
                this._state = state;
                this.button.classList.toggle('ce-inline-tool--active', state);
            }

            constructor({ api }) {
                this.api = api;
                this.button = null;
                this._state = false;
                this.tag = 'U';
                this.class = 'cdx-underline';
            }

            render() {
                this.button = document.createElement('button');
                this.button.type = 'button';
                this.button.innerHTML = '<u>U</u>';
                this.button.classList.add('ce-inline-tool');
                return this.button;
            }

            surround(range) {
                if (this.state) {
                    this.unwrap(range);
                    return;
                }
                this.wrap(range);
            }

            wrap(range) {
                const selectedText = range.extractContents();
                const mark = document.createElement(this.tag);
                mark.classList.add(this.class);
                mark.appendChild(selectedText);
                range.insertNode(mark);
                this.api.selection.expandToTag(mark);
            }

            unwrap(range) {
                const mark = this.api.selection.findParentTag(this.tag, this.class);
                const text = range.extractContents();
                mark.remove();
                range.insertNode(text);
            }

            checkState() {
                const mark = this.api.selection.findParentTag(this.tag);
                this.state = !!mark;
            }

            static get shortcut() {
                return 'CMD+U';
            }
        }

        // Custom Font Size Inline Tool
        class FontSizeTool {
            static get isInline() {
                return true;
            }

            static get sanitize() {
                return {
                    span: {
                        class: ['cdx-font-small', 'cdx-font-normal', 'cdx-font-large', 'cdx-font-xlarge']
                    }
                };
            }

            get state() {
                return this._state;
            }

            set state(state) {
                this._state = state;
                if (this.button) {
                    this.button.classList.toggle('ce-inline-tool--active', state);
                }
            }

            constructor({ api }) {
                this.api = api;
                this.button = null;
                this._state = false;
                this.tag = 'SPAN';
                this.currentSizeIndex = 1; // Start with Normal
                this.sizes = [
                    { name: 'S', class: 'cdx-font-small', label: 'Small' },
                    { name: 'M', class: 'cdx-font-normal', label: 'Normal' },
                    { name: 'L', class: 'cdx-font-large', label: 'Large' },
                    { name: 'XL', class: 'cdx-font-xlarge', label: 'X-Large' }
                ];
            }

            render() {
                this.button = document.createElement('button');
                this.button.type = 'button';
                this.button.innerHTML = '<svg width="14" height="14" viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg"><text x="0" y="11" font-size="11" font-weight="bold">A</text></svg>';
                this.button.classList.add('ce-inline-tool');
                this.button.title = 'Font Size (cycles through Small ‚Üí Normal ‚Üí Large ‚Üí X-Large)';
                return this.button;
            }

            surround(range) {
                if (!range) return;

                // Find existing span with font size
                const existingSpan = this.api.selection.findParentTag(this.tag);
                let currentIndex = 1; // Default to Normal

                if (existingSpan) {
                    // Find current size
                    for (let i = 0; i < this.sizes.length; i++) {
                        if (existingSpan.classList.contains(this.sizes[i].class)) {
                            currentIndex = i;
                            break;
                        }
                    }

                    // Remove all size classes
                    this.sizes.forEach(size => {
                        existingSpan.classList.remove(size.class);
                    });

                    // Move to next size
                    const nextIndex = (currentIndex + 1) % this.sizes.length;
                    const nextSize = this.sizes[nextIndex];

                    if (nextIndex === 1) {
                        // Normal size - unwrap
                        this.unwrap(range, existingSpan);
                    } else {
                        // Apply new size
                        existingSpan.classList.add(nextSize.class);
                        this.api.selection.expandToTag(existingSpan);
                    }
                } else {
                    // No existing span, create new one with Large size (skip Normal)
                    this.wrap(range, this.sizes[2].class); // Start with Large
                }

                this.updateButtonState();
            }

            wrap(range, sizeClass) {
                const selectedText = range.extractContents();
                const span = document.createElement(this.tag);
                span.classList.add(sizeClass);
                span.appendChild(selectedText);
                range.insertNode(span);
                this.api.selection.expandToTag(span);
            }

            unwrap(range, span) {
                if (!span) {
                    span = this.api.selection.findParentTag(this.tag);
                }
                if (span) {
                    const parent = span.parentNode;
                    while (span.firstChild) {
                        parent.insertBefore(span.firstChild, span);
                    }
                    parent.removeChild(span);
                }
            }

            checkState() {
                const span = this.api.selection.findParentTag(this.tag);
                this.state = !!span;
                this.updateButtonState();
            }

            updateButtonState() {
                const span = this.api.selection.findParentTag(this.tag);
                if (span && this.button) {
                    for (const size of this.sizes) {
                        if (span.classList.contains(size.class)) {
                            this.button.innerHTML = `<strong style="font-size: 12px;">${size.name}</strong>`;
                            return;
                        }
                    }
                }
                if (this.button) {
                    this.button.innerHTML = '<svg width="14" height="14" viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg"><text x="0" y="11" font-size="11" font-weight="bold">A</text></svg>';
                }
            }
        }

        let editor;

        // Sample data for demo
        const sampleData = {
            "time": 1672531200000,
            "blocks": [
                {
                    "type": "header",
                    "data": {
                        "text": "Welcome to Editor.js! üéâ",
                        "level": 2
                    }
                },
                {
                    "type": "paragraph",
                    "data": {
                        "text": "Editor.js is a <mark class=\"cdx-marker\">block-styled</mark> editor that outputs clean JSON data. It's perfect for creating rich content with a great user experience."
                    }
                },
                {
                    "type": "paragraph",
                    "data": {
                        "text": "You can now apply <b class=\"cdx-bold\">bold</b>, <i class=\"cdx-italic\">italic</i>, <u class=\"cdx-underline\">underline</u>, and <span class=\"cdx-font-large\">different font sizes</span> to your text!"
                    }
                },
                {
                    "type": "header",
                    "data": {
                        "text": "Key Features",
                        "level": 3
                    }
                },
                {
                    "type": "list",
                    "data": {
                        "style": "unordered",
                        "items": [
                            "Clean and semantic JSON output",
                            "Multiple block types support",
                            "Extensible with custom plugins",
                            "Mobile-friendly interface"
                        ]
                    }
                },
                {
                    "type": "checklist",
                    "data": {
                        "items": [
                            {
                                "text": "Install Editor.js",
                                "checked": true
                            },
                            {
                                "text": "Try different block types",
                                "checked": false
                            },
                            {
                                "text": "Build something awesome",
                                "checked": false
                            }
                        ]
                    }
                },
                {
                    "type": "quote",
                    "data": {
                        "text": "Editor.js is the perfect tool for creating structured content.",
                        "caption": "Happy Developer",
                        "alignment": "left"
                    }
                },
                {
                    "type": "code",
                    "data": {
                        "code": "const editor = new EditorJS({\n  holder: 'editorjs',\n  tools: {\n    header: Header,\n    list: List\n  }\n});"
                    }
                }
            ],
            "version": "2.29.1"
        };

        // Initialize Editor.js
        function initEditor(data = null) {
            editor = new EditorJS({
                holder: 'editorjs',
                autofocus: true,
                placeholder: 'Start typing or click + to add a block...',
                data: data,
                tools: {
                    header: {
                        class: Header,
                        inlineToolbar: true,
                        config: {
                            placeholder: 'Enter a header',
                            levels: [1, 2, 3, 4, 5, 6],
                            defaultLevel: 2
                        }
                    },
                    list: {
                        class: List,
                        inlineToolbar: true,
                        config: {
                            defaultStyle: 'unordered'
                        }
                    },
                    checklist: {
                        class: Checklist,
                        inlineToolbar: true
                    },
                    quote: {
                        class: Quote,
                        inlineToolbar: true,
                        config: {
                            quotePlaceholder: 'Enter a quote',
                            captionPlaceholder: 'Quote author'
                        }
                    },
                    code: {
                        class: CodeTool,
                        config: {
                            placeholder: 'Enter code'
                        }
                    },
                    warning: {
                        class: Warning,
                        inlineToolbar: true,
                        config: {
                            titlePlaceholder: 'Title',
                            messagePlaceholder: 'Message'
                        }
                    },
                    marker: {
                        class: Marker,
                        shortcut: 'CMD+SHIFT+M'
                    },
                    inlineCode: {
                        class: InlineCode,
                        shortcut: 'CMD+SHIFT+C'
                    },
                    bold: {
                        class: BoldInlineTool,
                        shortcut: 'CMD+B'
                    },
                    italic: {
                        class: ItalicInlineTool,
                        shortcut: 'CMD+I'
                    },
                    underline: {
                        class: UnderlineInlineTool,
                        shortcut: 'CMD+U'
                    },
                    fontSize: {
                        class: FontSizeTool
                    },
                    table: {
                        class: Table,
                        inlineToolbar: true
                    },
                    embed: {
                        class: Embed,
                        config: {
                            services: {
                                youtube: true,
                                vimeo: true,
                                twitter: true
                            }
                        }
                    },
                    linkTool: {
                        class: LinkTool,
                        config: {
                            endpoint: 'http://localhost:8008/fetchUrl' // Mock endpoint
                        }
                    }
                },
                onChange: () => {
                    console.log('Content changed');
                },
                onReady: () => {
                    console.log('Editor.js is ready to work!');
                }
            });
        }

        // Save editor data
        async function saveData() {
            try {
                const outputData = await editor.save();
                document.getElementById('output-data').textContent = JSON.stringify(outputData, null, 2);
                document.getElementById('output').classList.add('show');
                console.log('Saved data:', outputData);
            } catch (error) {
                console.error('Saving failed:', error);
                alert('Failed to save data!');
            }
        }

        // Clear editor
        async function clearEditor() {
            if (confirm('Are you sure you want to clear the editor?')) {
                await editor.clear();
                document.getElementById('output').classList.remove('show');
            }
        }

        // Load sample data
        async function loadSample() {
            if (editor) {
                await editor.destroy();
            }
            initEditor(sampleData);
        }

        // Initialize editor on page load
        initEditor(sampleData);
    </script>
</body>
</html>
